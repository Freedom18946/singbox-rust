[package]
name = "sb-core"
version = "0.1.0"
edition = "2021"

[dependencies]
# 原有依赖（保留）
anyhow = "1.0"
async-trait = "0.1"
base64 = "0.22"
bytes = "1.10"
chrono = "0.4"
clap = { version = "4.5", features = ["derive"] }
dashmap = "5.5"
fastrand = "2.3"  # 新增：用于随机 jitter
futures = "0.3"
getrandom = "0.3"
hex = "0.4"
hmac = "0.12"
http = "0.2"
hyper = "0.14"
lazy_static = "1.5"
log = "0.4"
once_cell = "1.21"  # 新增：用于 lazy static
parking_lot = "0.12"
rand = "0.8"
regex = "1.10"
ring = "0.17"
rustls = "0.23"
sb-config = { path = "../sb-config" }
sb-metrics = { path = "../sb-metrics" }
sb-platform = { path = "../sb-platform" }
sb-types = { path = "../sb-types" }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
serde_yaml = "0.9"
sha2 = "0.10"
smallvec = "1.15"  # 新增：用于小向量（如 DNS addrs）
socket2 = "0.6"  # 新增：用于 socket 配置
thiserror = "1.0"
tokio = { version = "1.47", features = ["full"] }
tokio-rustls = "0.26"
tokio-util = "0.7"
tower = "0.4"
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }
uuid = { version = "1.18", features = ["v4", "serde"] }
webpki-roots = "0.26"  # 新增：用于 TLS root certs

[dev-dependencies]
# 原有 dev-deps，如果有

[features]
default = []  # 默认 feature
scaffold = []  # 满足 app 依赖
# 新增：所有 unexpected cfg features（空实现，破警告；可后续添加 deps 如 out_ss = ["some-crate"]）
error-v2 = []
out_trojan = []
out_ss = []
out_shadowtls = []
out_naive = []
out_vless = []
out_vmess = []
out_tuic = []
out_hysteria2 = []
out_wireguard = []
out_ssh = []
out_quic = []
selector_p3 = []
dns_doh = []
dns_dot = []
dns_http = []
dns_udp = []
dns_cache = []
tls_rustls = []  # 匹配代码中的 tls_rustls（或改代码为 tls-rustls）
