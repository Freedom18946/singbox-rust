## 临时实例（ephemeral）多次探针：为什么需要？

- **问题**：复用同一长驻实例做连续连接，偶发命中 TIME_WAIT/端口复用策略导致拒连或抖动。
- **方案**：每次探针启动**临时实例**做 10 连发，结束即退出；取**最后一行 actual**端口。
- **实现**：`run_and_test.zsh` 端口解析**最后一行 + 重试**（100ms*30）；`.e2e/sing.log` 作为无 ANSI 源，避免控制字符污染。

## macOS 与 GNU 工具差异
- **awk/sed 差异**：BSD awk/sed 与 GNU 语法不同；稳定做法是 `grep | sed -E` 子集。
- **端口提取**：统一 `grep -Eo 'actual=127\.0\.0\.1:[0-9]+' | tail -n 1 | sed -E 's/.*://'`。

## 观测建议
- HTTP 405/400：记录 `bytes / cost_ms`（debug），主线默认 info 不污染。
- metrics 未启：打印 `[SKIP] metrics disabled`，避免误报失败。
